// From some conversations, ramblings and postings on the u-Blox forum
// https://portal.u-blox.com/s/question/0D52p00008HKCkJCAX/how-to-verify-ubxsecsign
//****************************************************************************

/*

If this saves you several man-hours/days consider https://paypal.me/cliveone
  23-February-2023  sourcer32@gmail.com

FIXSEED 0x01234567,0x89ABCDEF
DYNSEED 0x00000000,0x00000000
-----------------------------------------------------------------------------
0A 04 MON-VER    - 25 93 : 25 93 198
UBX-MON-VER
0000 : B5 62 0A 04 BE 00 45 58-54 20 43 4F 52 45 20 33 .b....EXT CORE 3
0010 : 2E 30 31 20 28 31 31 31-31 36 30 29 00 00 00 00 .01 (111160)....
0020 : 00 00 00 00 30 30 30 38-30 30 30 30 00 00 52 4F ....00080000..RO
0030 : 4D 20 42 41 53 45 20 32-2E 30 31 20 28 37 35 33 M BASE 2.01 (753
0040 : 33 31 29 00 00 00 00 00-00 00 00 00 46 57 56 45 31).........FWVE
0050 : 52 3D 48 50 47 20 31 2E-30 30 00 00 00 00 00 00 R=HPG 1.00......
0060 : 00 00 00 00 00 00 00 00-00 00 50 52 4F 54 56 45 ..........PROTVE
0070 : 52 3D 32 30 2E 30 30 00-00 00 00 00 00 00 00 00 R=20.00.........
0080 : 00 00 00 00 00 00 00 00-46 49 53 3D 30 78 45 46 ........FIS=0xEF
0090 : 34 30 31 35 20 28 31 30-30 31 31 31 29 00 00 00 4015 (100111)...
00A0 : 00 00 00 00 00 00 47 50-53 3B 47 4C 4F 00 00 00 ......GPS;GLO...
00B0 : 00 00 00 00 00 00 00 00-00 00 00 00 00 00 00 00 ................
00C0 : 00 00 00 00 25 93                               ....%.

EXT CORE 3.01 (111160)
00080000
ROM BASE 2.01 (75331)
FWVER=HPG 1.00
PROTVER=20.00
FIS=0xEF4015 (100111)
GPS;GLO
-----------------------------------------------------------------------------
27 01 UBX-SEC-SIGN - 25 19 : 25 19 48
UBX-SEC-SIGN
0000 : 01 00 00 00 0A 04 25 93-09 67 1F FD FE 34 FA 20 ......%..g...4.
0010 : A2 8D 23 D2 E3 BA 88 D6-8E 5E AB F2 6F 28 38 B7 ..#......^..o(8.
0020 : BE 24 F9 ED 02 ED 8A C7-                        .$......

MSG: 0A 04
CHK: 25 93
SHA: 09671FFDFE34FA20A28D23D2E3BA88D68E5EABF26F2838B7BE24F9ED02ED8AC7
-----------------------------------------------------------------------------
*/

void secsign(void)
{
  static const unsigned char test[] = {
    0x67,0x45,0x23,0x01, // fixed 0x01234567
    0x00,0x00,0x00,0x00, // dynamic

    0xB5,0x62,
    0x0A,0x04,
    0xBE,0x00,
    0x45,0x58,0x54,0x20,0x43,0x4F,0x52,0x45,0x20,0x33,0x2E,0x30,0x31,0x20,0x28,0x31,
    0x31,0x31,0x31,0x36,0x30,0x29,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x30,0x30,
    0x30,0x38,0x30,0x30,0x30,0x30,0x00,0x00,0x52,0x4F,0x4D,0x20,0x42,0x41,0x53,0x45,
    0x20,0x32,0x2E,0x30,0x31,0x20,0x28,0x37,0x35,0x33,0x33,0x31,0x29,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x46,0x57,0x56,0x45,0x52,0x3D,0x48,0x50,0x47,0x20,
    0x31,0x2E,0x30,0x30,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x50,0x52,0x4F,0x54,0x56,0x45,0x52,0x3D,0x32,0x30,0x2E,0x30,
    0x30,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x46,0x49,0x53,0x3D,0x30,0x78,0x45,0x46,0x34,0x30,0x31,0x35,0x20,0x28,
    0x31,0x30,0x30,0x31,0x31,0x31,0x29,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x47,0x50,0x53,0x3B,0x47,0x4C,0x4F,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x25,0x93, // checksum

    0x00,0x00,0x00,0x00, // dynamic
    0xEF,0xCD,0xAB,0x89, // fixed 0x89ABCDEF
 }; // 09 67 1F FD FE 34 FA 20 A2 8D 23 D2 E3 BA 88 D6-8E 5E AB F2 6F 28 38 B7 BE 24 F9 ED 02 ED 8A C7

  sha256_context ctx;
  BYTE hash[32];
  int i;

  sha256_starts(&ctx);

  sha256_update(&ctx, (void *)test, sizeof(test));

  sha256_finish(&ctx, hash);

  for(i=0; i<32; i++)
    printf("%02X", hash[i]);

  putchar('\n');
}

//****************************************************************************

